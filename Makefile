export SUDO 											= echo $(USER_PASSWORD) | sudo -S
export PCAP_RAMDISK_SIZE 								= 100g

export CAIDA_DATASET_DIR								= $(HOME)/research/CAIDA/Equinix-2019/data.caida.org/datasets/passive-2019/equinix-nyc/20190117-130000.UTC/pcap
export CAIDA_PCAP_1     								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-125910.UTC.anon.pcap
export CAIDA_PCAP_2     								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-130000.UTC.anon.pcap
export CAIDA_PCAP_3     								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-130100.UTC.anon.pcap
export CAIDA_PCAP_4     								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-130200.UTC.anon.pcap
export CAIDA_PCAP_5     								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-130300.UTC.anon.pcap
export CAIDA_PCAP_6     								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-130400.UTC.anon.pcap
export CAIDA_PCAP_7     								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-130500.UTC.anon.pcap
export CAIDA_PCAP_8     								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-130600.UTC.anon.pcap
export CAIDA_PCAP_9     								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-130700.UTC.anon.pcap
export CAIDA_PCAP_10    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-130800.UTC.anon.pcap
export CAIDA_PCAP_11    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-130900.UTC.anon.pcap
export CAIDA_PCAP_12    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-131000.UTC.anon.pcap
export CAIDA_PCAP_13    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-131100.UTC.anon.pcap
export CAIDA_PCAP_14    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-131147.UTC.anon.pcap
export CAIDA_PCAP_15    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-131200.UTC.anon.pcap
export CAIDA_PCAP_16    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-131300.UTC.anon.pcap
export CAIDA_PCAP_17    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-131400.UTC.anon.pcap
export CAIDA_PCAP_18    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-131500.UTC.anon.pcap
export CAIDA_PCAP_19    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-131558.UTC.anon.pcap
export CAIDA_PCAP_20    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-131600.UTC.anon.pcap
export CAIDA_PCAP_21    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-131700.UTC.anon.pcap
export CAIDA_PCAP_22    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-131800.UTC.anon.pcap
export CAIDA_PCAP_23    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-131900.UTC.anon.pcap
export CAIDA_PCAP_24    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-132000.UTC.anon.pcap
export CAIDA_PCAP_25    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-132100.UTC.anon.pcap
export CAIDA_PCAP_26    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-132200.UTC.anon.pcap
export CAIDA_PCAP_27    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-132300.UTC.anon.pcap
export CAIDA_PCAP_28    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-132400.UTC.anon.pcap
export CAIDA_PCAP_29    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-132500.UTC.anon.pcap
export CAIDA_PCAP_30    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-132600.UTC.anon.pcap
export CAIDA_PCAP_31    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-132700.UTC.anon.pcap
export CAIDA_PCAP_32    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-132800.UTC.anon.pcap
export CAIDA_PCAP_33    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-132900.UTC.anon.pcap
export CAIDA_PCAP_34    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-133000.UTC.anon.pcap
export CAIDA_PCAP_35    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-133100.UTC.anon.pcap
export CAIDA_PCAP_36    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-133200.UTC.anon.pcap
export CAIDA_PCAP_37    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-133300.UTC.anon.pcap
export CAIDA_PCAP_38    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-133400.UTC.anon.pcap
export CAIDA_PCAP_39    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-133500.UTC.anon.pcap
export CAIDA_PCAP_40    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-133600.UTC.anon.pcap
export CAIDA_PCAP_41    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-133700.UTC.anon.pcap
export CAIDA_PCAP_42    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-133800.UTC.anon.pcap
export CAIDA_PCAP_43    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-133900.UTC.anon.pcap
export CAIDA_PCAP_44    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-134000.UTC.anon.pcap
export CAIDA_PCAP_45    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-134100.UTC.anon.pcap
export CAIDA_PCAP_46    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-134200.UTC.anon.pcap
export CAIDA_PCAP_47    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-134300.UTC.anon.pcap
export CAIDA_PCAP_48    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-134400.UTC.anon.pcap
export CAIDA_PCAP_49    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-134500.UTC.anon.pcap
export CAIDA_PCAP_50    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-134600.UTC.anon.pcap
export CAIDA_PCAP_51    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-134700.UTC.anon.pcap
export CAIDA_PCAP_52    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-134800.UTC.anon.pcap
export CAIDA_PCAP_53    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-134900.UTC.anon.pcap
export CAIDA_PCAP_54    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-135000.UTC.anon.pcap
export CAIDA_PCAP_55    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-135100.UTC.anon.pcap
export CAIDA_PCAP_56    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-135200.UTC.anon.pcap
export CAIDA_PCAP_57    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-135300.UTC.anon.pcap
export CAIDA_PCAP_58    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-135400.UTC.anon.pcap
export CAIDA_PCAP_59    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-135500.UTC.anon.pcap
export CAIDA_PCAP_60    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-135600.UTC.anon.pcap
export CAIDA_PCAP_61    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-135700.UTC.anon.pcap
export CAIDA_PCAP_62    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-135800.UTC.anon.pcap
export CAIDA_PCAP_63    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-135900.UTC.anon.pcap
export CAIDA_PCAP_64    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-140000.UTC.anon.pcap
export CAIDA_PCAP_65    								= $(CAIDA_DATASET_DIR)/equinix-nyc.dirA.20190117-140100.UTC.anon.pcap

export TREX_VERSION 									= 2.97
export TREX_PACKAGE										= v$(TREX_VERSION).tar.gz
export TREX_DOWNLOAD_LINK								= https://trex-tgn.cisco.com/trex/release/$(TREX_PACKAGE)
export TREX_DIRECTORY									= v$(TREX_VERSION)
export TREX_CONFIG_FILE									= $(PWD)/trex-config.yaml

export TREX_PORT_SETUP_EXECUTABLE						= $(SUDO) ./dpdk_setup_ports.py
export TREX_TRAFFIC_GEN_EXECUTABLE						= ./t-rex-64
export TREX_CONSOLE_EXECUTABLE							= ./trex-console

export PYTHON3_FINDER_SCRIPT							= $(TREX_DIRECTORY)/find_python.sh
export PYTHON3_FIX										= PYTHONS3_LOCAL=( python3 /usr/bin/python3 /home/annuszulfiqar/miniconda3/bin/python)

export DEPENDENCIES_DIR									= $(PWD)/deps

# classbench variables		
export CLASSBENCH_SOURCE_DIR							= $(DEPENDENCIES_DIR)/db_generator
export CLASSBENCH_RULE_PARAMETERS_DIR					= $(CLASSBENCH_SOURCE_DIR)/parameter_files
export CLASSBENCH_GENERATED_RULES_DIR					= $(CLASSBENCH_SOURCE_DIR)/generated_rules
export CLASSBENCH_EXECUTABLE							= ./db_generator

export CLASSBENCH_PARAMETERS_ACL1						= $(CLASSBENCH_RULE_PARAMETERS_DIR)/acl1_seed
export CLASSBENCH_PARAMETERS_ACL2						= $(CLASSBENCH_RULE_PARAMETERS_DIR)/acl2_seed
export CLASSBENCH_PARAMETERS_ACL3						= $(CLASSBENCH_RULE_PARAMETERS_DIR)/acl3_seed
export CLASSBENCH_PARAMETERS_ACL4						= $(CLASSBENCH_RULE_PARAMETERS_DIR)/acl4_seed
export CLASSBENCH_PARAMETERS_ACL5						= $(CLASSBENCH_RULE_PARAMETERS_DIR)/acl5_seed
export CLASSBENCH_PARAMETERS_FW1						= $(CLASSBENCH_RULE_PARAMETERS_DIR)/fw1_seed
export CLASSBENCH_PARAMETERS_FW2						= $(CLASSBENCH_RULE_PARAMETERS_DIR)/fw2_seed
export CLASSBENCH_PARAMETERS_FW3						= $(CLASSBENCH_RULE_PARAMETERS_DIR)/fw3_seed
export CLASSBENCH_PARAMETERS_FW4						= $(CLASSBENCH_RULE_PARAMETERS_DIR)/fw4_seed
export CLASSBENCH_PARAMETERS_FW5						= $(CLASSBENCH_RULE_PARAMETERS_DIR)/fw5_seed
export CLASSBENCH_PARAMETERS_IPC1						= $(CLASSBENCH_RULE_PARAMETERS_DIR)/ipc1_seed
export CLASSBENCH_PARAMETERS_IPC2						= $(CLASSBENCH_RULE_PARAMETERS_DIR)/ipc2_seed

export CLASSBENCH_RULES_100K_ACL1_FILE					= $(CLASSBENCH_GENERATED_RULES_DIR)/acl1_100K_rules.txt
export CLASSBENCH_RULES_100K_ACL2_FILE					= $(CLASSBENCH_GENERATED_RULES_DIR)/acl2_100K_rules.txt
export CLASSBENCH_RULES_100K_ACL3_FILE					= $(CLASSBENCH_GENERATED_RULES_DIR)/acl3_100K_rules.txt
export CLASSBENCH_RULES_100K_ACL4_FILE					= $(CLASSBENCH_GENERATED_RULES_DIR)/acl4_100K_rules.txt
export CLASSBENCH_RULES_100K_ACL5_FILE					= $(CLASSBENCH_GENERATED_RULES_DIR)/acl5_100K_rules.txt
export CLASSBENCH_RULES_100K_FW1_FILE					= $(CLASSBENCH_GENERATED_RULES_DIR)/fw1_100K_rules.txt
export CLASSBENCH_RULES_100K_FW2_FILE					= $(CLASSBENCH_GENERATED_RULES_DIR)/fw2_100K_rules.txt
export CLASSBENCH_RULES_100K_FW3_FILE					= $(CLASSBENCH_GENERATED_RULES_DIR)/fw3_100K_rules.txt
export CLASSBENCH_RULES_100K_FW4_FILE					= $(CLASSBENCH_GENERATED_RULES_DIR)/fw4_100K_rules.txt
export CLASSBENCH_RULES_100K_FW5_FILE					= $(CLASSBENCH_GENERATED_RULES_DIR)/fw5_100K_rules.txt
export CLASSBENCH_RULES_100K_IPC1_FILE					= $(CLASSBENCH_GENERATED_RULES_DIR)/ipc1_100K_rules.txt
export CLASSBENCH_RULES_100K_IPC2_FILE					= $(CLASSBENCH_GENERATED_RULES_DIR)/ipc2_100K_rules.txt

# classbench-mapper variables		
export CLASSBENCH_MAPPER_SOURCE_DIR						= $(DEPENDENCIES_DIR)/classbench-mapper
export CLASSBENCH_MAPPER_MAPPED_RULES_DIR				= $(CLASSBENCH_MAPPER_SOURCE_DIR)/mapped_rules
export CLASSBENCH_MAPPER_EXECUTABLE						= bin/util-cb-map.exe

export CLASSBENCH_MAPPED_RULES_100K_ACL1_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/acl1_100K_mapped_rules.txt
export CLASSBENCH_MAPPED_RULES_100K_ACL2_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/acl2_100K_mapped_rules.txt
export CLASSBENCH_MAPPED_RULES_100K_ACL3_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/acl3_100K_mapped_rules.txt
export CLASSBENCH_MAPPED_RULES_100K_ACL4_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/acl4_100K_mapped_rules.txt
export CLASSBENCH_MAPPED_RULES_100K_ACL5_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/acl5_100K_mapped_rules.txt
export CLASSBENCH_MAPPED_RULES_100K_FW1_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/fw1_100K_mapped_rules.txt
export CLASSBENCH_MAPPED_RULES_100K_FW2_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/fw2_100K_mapped_rules.txt
export CLASSBENCH_MAPPED_RULES_100K_FW3_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/fw3_100K_mapped_rules.txt
export CLASSBENCH_MAPPED_RULES_100K_FW4_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/fw4_100K_mapped_rules.txt
export CLASSBENCH_MAPPED_RULES_100K_FW5_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/fw5_100K_mapped_rules.txt
export CLASSBENCH_MAPPED_RULES_100K_IPC1_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/ipc1_100K_mapped_rules.txt
export CLASSBENCH_MAPPED_RULES_100K_IPC2_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/ipc2_100K_mapped_rules.txt

# classbench int-to-rule mappings
export CLASSBENCH_MAPING_RULES_100K_ACL1_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/acl1_100K_mapping.txt
export CLASSBENCH_MAPING_RULES_100K_ACL2_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/acl2_100K_mapping.txt
export CLASSBENCH_MAPING_RULES_100K_ACL3_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/acl3_100K_mapping.txt
export CLASSBENCH_MAPING_RULES_100K_ACL4_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/acl4_100K_mapping.txt
export CLASSBENCH_MAPING_RULES_100K_ACL5_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/acl5_100K_mapping.txt
export CLASSBENCH_MAPING_RULES_100K_FW1_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/fw1_100K_mapping.txt
export CLASSBENCH_MAPING_RULES_100K_FW2_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/fw2_100K_mapping.txt
export CLASSBENCH_MAPING_RULES_100K_FW3_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/fw3_100K_mapping.txt
export CLASSBENCH_MAPING_RULES_100K_FW4_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/fw4_100K_mapping.txt
export CLASSBENCH_MAPING_RULES_100K_FW5_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/fw5_100K_mapping.txt
export CLASSBENCH_MAPING_RULES_100K_IPC1_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/ipc1_100K_mapping.txt
export CLASSBENCH_MAPING_RULES_100K_IPC2_FILE			= $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)/ipc2_100K_mapping.txt

# pcap-analyzer variables		
export PCAP_ANALYZER_SOURCE_DIR							= $(DEPENDENCIES_DIR)/pcap-file-analyzer
export PCAP_ANALYZER_GENERATED_PROFILES_DIR				= $(PCAP_ANALYZER_SOURCE_DIR)/generated_profiles
export PCAP_ANALYZER_EXECUTABLE							= bin/util-pcap-analyzer.exe
export CAIDA_LOCALITY_PROFILE							= $(PCAP_ANALYZER_GENERATED_PROFILES_DIR)/caida-locality.txt
export CAIDA_TIMING_PROFILE								= $(PCAP_ANALYZER_GENERATED_PROFILES_DIR)/caida-timing.txt
export CAIDA_SIZE_PROFILE								= $(PCAP_ANALYZER_GENERATED_PROFILES_DIR)/caida-sizes.txt

################################################################ Trex Setup ################################################################
get-trex-v2.97:
	wget --no-cache $(TREX_DOWNLOAD_LINK) --no-check-certificate

fix-python3:
	sed -i '1s|.*|$(PYTHON3_FIX)|' $(PYTHON3_FINDER_SCRIPT)

setup-trex: get-trex-v2.97
	tar -xzvf $(TREX_PACKAGE)

################################################################ Hugepages ################################################################
show-hugepages:
	grep HugePages_ /proc/meminfo

# $(SUDO) sysctl -w vm.nr_hugepages=2048  # where N = No. of 2M huge pages
setup-hugepages:
	@echo Please run this target as root [sudo -s]
	echo 2048 > /sys/devices/system/node/node0/hugepages/hugepages-2048kB/nr_hugepages
	echo 2048 > /sys/devices/system/node/node0/hugepages/hugepages-1048576kB/nr_hugepages

reset-hugepages:
	@echo Please run this target as root [sudo -s]
	echo 0 > /sys/devices/system/node/node0/hugepages/hugepages-2048kB/nr_hugepages
	echo 0 > /sys/devices/system/node/node0/hugepages/hugepages-1048576kB/nr_hugepages

release-hugepages:
	$(SUDO) rm -rf /dev/hugepages/rtemap_*

mount-hugepages:
	$(SUDO) mount -t hugetlbfs none /dev/hugepages

################################################################ T-rex and NICs ################################################################
mount-ramdisk:
	mkdir -p /mnt/pcap-ramdisk
	chmod 777 /mnt/pcap-ramdisk
	mount -t tmpfs -o size=$(PCAP_RAMDISK_SIZE) pcap-ramdisk /mnt/pcap-ramdisk

unmount-ramdisk:
	umount /mnt/pcap-ramdisk
	rmdir /mnt/pcap-ramdisk

################################################################ T-rex and NICs ################################################################
show-dpdk-devices:
	cd $(TREX_DIRECTORY) && $(TREX_PORT_SETUP_EXECUTABLE) -s

################################################################ Tests ################################################################
show-trex-help:
	cd $(TREX_DIRECTORY) && sudo -S $(TREX_TRAFFIC_GEN_EXECUTABLE) --help

run-dns-test: release-hugepages
	cd $(TREX_DIRECTORY) && sudo -S $(TREX_TRAFFIC_GEN_EXECUTABLE) -f cap2/dns.yaml -c 4 -m 1 -d 10

run-20Gbps-test: release-hugepages
	cd $(TREX_DIRECTORY) && sudo -S $(TREX_TRAFFIC_GEN_EXECUTABLE) -f avl/sfr_delay_10_1g.yaml -c 24 -m 20 -d 100 -l 1000

run-udp-64byte-imix-20Gbps-test: release-hugepages
	cd $(TREX_DIRECTORY) && sudo -S $(TREX_TRAFFIC_GEN_EXECUTABLE) -f cap2/imix_64.yaml -c 24 -m 1 -d 100 -l 1000

run-100Gbps-test: release-hugepages
	cd $(TREX_DIRECTORY) && sudo -S $(TREX_TRAFFIC_GEN_EXECUTABLE) -f avl/sfr_delay_10_1g.yaml -c 24 -m 100 -d 100 -l 1000

run-200Gbps-test: release-hugepages
	cd $(TREX_DIRECTORY) && sudo -S $(TREX_TRAFFIC_GEN_EXECUTABLE) -f avl/sfr_delay_10_1g.yaml -c 24 -m 200 -d 100 -l 1000

run-400Gbps-test: release-hugepages
	cd $(TREX_DIRECTORY) && sudo -S $(TREX_TRAFFIC_GEN_EXECUTABLE) -f avl/sfr_delay_10_1g.yaml -c 24 -m 400 -d 100 -l 1000

start-t-rex-interactive-console: release-hugepages
	cd $(TREX_DIRECTORY) && sudo -S $(TREX_TRAFFIC_GEN_EXECUTABLE) --cfg $(TREX_CONFIG_FILE) -i -c 24

connect-to-t-rex-interactive-console:
	cd $(TREX_DIRECTORY) && $(TREX_CONSOLE_EXECUTABLE)

################################################################ classbench ################################################################
build-classbench:
	cd $(CLASSBENCH_SOURCE_DIR) && make all

show-classbench-help:
	cd $(CLASSBENCH_SOURCE_DIR) && $(CLASSBENCH_EXECUTABLE) -h

$(CLASSBENCH_GENERATED_RULES_DIR):
	@echo "[LOG] Creating $(CLASSBENCH_GENERATED_RULES_DIR)"
	mkdir $(CLASSBENCH_GENERATED_RULES_DIR)

generate-100K-classbench-ACL1-rules: | $(CLASSBENCH_GENERATED_RULES_DIR)
	cd $(CLASSBENCH_SOURCE_DIR) && $(CLASSBENCH_EXECUTABLE) -bc $(CLASSBENCH_PARAMETERS_ACL1) 300000 64 0.0 0.0 $(CLASSBENCH_RULES_100K_ACL1_FILE)

################################################################ classbench-mapper ################################################################
build-classbench-mapper:
	cd $(CLASSBENCH_MAPPER_SOURCE_DIR) && ./build.sh
	cd $(CLASSBENCH_MAPPER_SOURCE_DIR) && make
	cd $(CLASSBENCH_MAPPER_SOURCE_DIR) && ./$(CLASSBENCH_MAPPER_EXECUTABLE) --help

clean-classbench-mapper-build:
	cd $(CLASSBENCH_MAPPER_SOURCE_DIR) && make clean

show-classbench-mapper-help:
	cd $(CLASSBENCH_MAPPER_SOURCE_DIR) && ./$(CLASSBENCH_MAPPER_EXECUTABLE) --help

$(CLASSBENCH_MAPPER_MAPPED_RULES_DIR):
	@echo "[LOG] Creating $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)"
	mkdir $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)

map-classbench-ACL1-rules-to-OVS-rules: | $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)
	cd $(CLASSBENCH_MAPPER_SOURCE_DIR) && ./$(CLASSBENCH_MAPPER_EXECUTABLE) --mode-ovs-flows \
		--ruleset $(CLASSBENCH_RULES_100K_ACL1_FILE) --out $(CLASSBENCH_MAPPED_RULES_100K_ACL1_FILE)

map-classbench-ACL1-rules-to-numbered-mapping: | $(CLASSBENCH_MAPPER_MAPPED_RULES_DIR)
	cd $(CLASSBENCH_MAPPER_SOURCE_DIR) && ./$(CLASSBENCH_MAPPER_EXECUTABLE) --mode-mapping \
		--ruleset $(CLASSBENCH_RULES_100K_ACL1_FILE) --out $(CLASSBENCH_MAPING_RULES_100K_ACL1_FILE)

################################################################ pcap-analyzer ################################################################
generate-caida-profile:
	cd $(PCAP_ANALYZER_SOURCE_DIR) && ./$(PCAP_ANALYZER_EXECUTABLE) --mode-pcap --pcap \
		"$(CAIDA_PCAP_1);$(CAIDA_PCAP_2);$(CAIDA_PCAP_3);$(CAIDA_PCAP_4);$(CAIDA_PCAP_5);$(CAIDA_PCAP_6);$(CAIDA_PCAP_7);$(CAIDA_PCAP_8);$(CAIDA_PCAP_9);$(CAIDA_PCAP_10);$(CAIDA_PCAP_11);$(CAIDA_PCAP_12);$(CAIDA_PCAP_13);$(CAIDA_PCAP_14);$(CAIDA_PCAP_15);$(CAIDA_PCAP_16);$(CAIDA_PCAP_17);$(CAIDA_PCAP_18);$(CAIDA_PCAP_19);$(CAIDA_PCAP_20);$(CAIDA_PCAP_21);$(CAIDA_PCAP_22);$(CAIDA_PCAP_23);$(CAIDA_PCAP_24);$(CAIDA_PCAP_25);$(CAIDA_PCAP_26);$(CAIDA_PCAP_27);$(CAIDA_PCAP_28);$(CAIDA_PCAP_29);$(CAIDA_PCAP_30);$(CAIDA_PCAP_31);$(CAIDA_PCAP_32);$(CAIDA_PCAP_33);$(CAIDA_PCAP_34);$(CAIDA_PCAP_35);$(CAIDA_PCAP_36);$(CAIDA_PCAP_37);$(CAIDA_PCAP_38);$(CAIDA_PCAP_39);$(CAIDA_PCAP_40);$(CAIDA_PCAP_41);$(CAIDA_PCAP_42);$(CAIDA_PCAP_43);$(CAIDA_PCAP_44);$(CAIDA_PCAP_45);$(CAIDA_PCAP_46);$(CAIDA_PCAP_47);$(CAIDA_PCAP_48);$(CAIDA_PCAP_49);$(CAIDA_PCAP_50);$(CAIDA_PCAP_51);$(CAIDA_PCAP_52);$(CAIDA_PCAP_53);$(CAIDA_PCAP_54);$(CAIDA_PCAP_55);$(CAIDA_PCAP_56);$(CAIDA_PCAP_57);$(CAIDA_PCAP_58);$(CAIDA_PCAP_59);$(CAIDA_PCAP_60);$(CAIDA_PCAP_61);$(CAIDA_PCAP_62);$(CAIDA_PCAP_63);$(CAIDA_PCAP_64);$(CAIDA_PCAP_65)" \
		--out $(CAIDA_LOCALITY_PROFILE) --out-times $(CAIDA_TIMING_PROFILE) --out-sizes $(CAIDA_SIZE_PROFILE)
